<!DOCTYPE html>
<html>
<head>
	<base href="/">
	<meta charset="utf-8">
	<title>newsMK</title>
	<link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat&display=swap" rel="stylesheet">
	<link rel="stylesheet" href="css">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    
    <script src="user-header-js"></script>
    <script src="user-footer-js"></script>
</head>
<body>

    <div id="page-mask"></div> <!-- page mask -->

    <div id="header-place" style="display: none;"></div> <!-- header place -->

    <div class="new-header">
        <div class="big-header"><a href="/">newsMK<span class="big-header-part">.mk</span></a></div>

        <div class="smaller-header">
            <div id="cats-wrapper" class="header-categories">
                <!-- <div class="one-category">Македонија</div>
                <div class="one-category category-with-border">Свет</div>
                <div class="one-category category-with-border">Спорт</div>
                <div class="one-category category-with-border">Забава</div>
                <div class="one-category category-with-border">Магазин</div>
                <div class="one-category category-with-border">Твитови</div> -->
            </div>

            <script type="text/javascript">
                $(document).ready(function(){
                    $.ajax({
                        url: 'users/all-categories',
                        success: function(data){
                            // console.log(data)

                            const categories = data.categories;

                            var i = 0;
                            while( i < categories.length){

                                const singleCategory = $('<a>').addClass('one-category').append(categories[i].name).attr({ 'href':'category?catId=' + categories[i].ID });

                                $('#cats-wrapper').append(singleCategory);

                                i++;
                            }
                        }, error: function(error){
                            // console.log(error);
                        }
                    })
                })
            </script>

            <div class="menu">
                <div class="menu-item"><img src="client/search-icon"></div>
                <div id="show-login" class="menu-item" onclick='showLogin()'><img src="client/user-icon"></div>
                <div class="menu-item"><img src="client/hamb-icon" style="filter: invert(100%);"></div>
            </div>
        </div>
        
    </div> <!-- new header -->

    <script type="text/javascript">
        $(document).ready(function(){
            $('#show-login').click(function(){
                $('#page-mask').fadeIn('fast');
                $('#login-wrapper').fadeIn('fast');
                console.log('leo')
            })

            showLogin = () => {
                $('#page-mask').fadeIn('fast');
                $('#login-wrapper').fadeIn('fast');
            }

            $('#page-mask').click(function(){
                $('.login-wrapper').fadeOut('slow');
                $('#page-mask').fadeOut('slow');
            })
        })

        $(document).keyup(function(e) {
            if (e.key === "Escape") {
                $('.login-wrapper').fadeOut('slow');
                $('#page-mask').fadeOut('slow');
            }
        });
    </script>

    

    <div id="login-wrapper" class="login-wrapper">
        <div class="login-top">
            <div class="person-icon"><img src="client/user-icon" alt="user" style="filter:invert(100%)"></div> <!-- person icon -->

            <div class="close-icon"></div> <!-- close icon -->
        </div><!-- login top -->

        <div class="login-title">
            <div class="login">Log In</div> <!-- log in -->

            <div class="register">Need newsMK account? <a href="#">Sign up</a></div><!-- register -->
        </div> <!-- login title -->

        <div class="login-form">
            <div class="row">
                <div class="label">Email</div>
                <input type="text">
            </div>

            <div class="row">
                <div class="label">Password</div>
                <input type="text">
            </div>

            <div class="forgot-password"><a href="#">Forgot password?</a></div>

            <div class="stay-logged">
                <div id='checkbox' class="checkbox"></div> <!-- check box -->

                <script type="text/javascript">
                    $(document).ready(function(){
                        $('#checkbox').click(function(event){
                            event.preventDefault();

                            $('.checkbox').css({ 'background':'whitesmoke' })

                        })
                    })
                </script>

                <!-- <input type="checkbox"> -->
                <div class="stay-logged-label">Stay logged in</div>
            </div> <!-- stay logged in -->

            <div class="login-btn">Log In</div><!-- login btn-->
        </div> <!-- login form -->
    </div><!-- login form -->

    <div class="main-section">
        <div class="main-first">
            <a id="big-post-wrapper" class="big-post-wrapper">
                <div id="big-post" class="big-post"></div><!-- big post -->
            </a>

            <script type="text/javascript">
                $(document).ready(function(){
                    $.ajax({
                        url: 'users/big-post',
                        success: function(data){
                            const bigPost = data.bigPost;

                            const bigPostInfo = $('<div>').addClass('big-post-info');
                                const bigPostTitle = $('<div>').addClass('big-post-title').append(bigPost[0].title);
                            bigPostInfo.append(bigPostTitle);
                                const bigPostSmallTitle = $('<div>').addClass('big-post-small-title').append(bigPost[0].small_title);
                            bigPostInfo.append(bigPostSmallTitle);
                                const bigPostCategory = $('<a>').addClass('big-post-category').append(bigPost[0].category).attr({ 'href':'category?catId=' + bigPost[0].category_id });
                            bigPostInfo.append(bigPostCategory);

                            $('#big-post-wrapper').attr({ 'href':'post?postId=' + bigPost[0].ID });

                            $('#big-post').append(bigPostInfo);

                            const bigPostImageDiv = $('<div>').addClass('big-post-image');
                                const bigPostImage = $('<img>').attr({ 'src':'admin/post-image?image=' + bigPost[0].image });
                            bigPostImageDiv.append(bigPostImage);

                            $('#big-post').append(bigPostImageDiv);

                            $('.big-post-wrapper').attr({ 'id': bigPost[0].ID });

                        }, error: function(error){
                            // console.log(error);

                        }
                    })
                })
            </script>
    
            <div id="first-two" class="two-posts"></div>

            <script type="text/javascript">
                $(document).ready(function(){
                    $.ajax({
                        url: 'users/two-posts',
                        success: function(data){
                            // console.log(data)
                            const posts = data.posts;

                            var i = 0;
                            while(i < posts.length){

                                const singlePost = $('<div>').addClass('single-post');
                                    const postImageDiv = $('<div>').addClass('post-image');
                                        const postImage = $('<img>').attr({ 'src': 'admin/post-image?image=' + posts[i].image });
                                    postImageDiv.append(postImage);
                                    
                                    const postTitle = $('<div>').addClass('post-title').append(posts[i].title);
                                    const postSmallTitle = $('<div>').addClass('post-small-title').append(posts[i].title);
                                    const postCategory = $('<a>').attr({ 'href':'category?catId=' + posts[i].category_id }).append(posts[i].category).css({ 'font-weight':'bold' });
                                    const postCatTile = $('<div>').addClass('post-cat-time').append(posts[i].time_posted + ' ' + '|' + ' ');
                                        postCatTile.append(postCategory)
                                singlePost.append(postImageDiv)
                                singlePost.append(postTitle)
                                singlePost.append(postSmallTitle)
                                singlePost.append(postCatTile)

                                $('#first-two').append(singlePost);

                                i++;
                            }

                        }, error: function(error){
                            // console.log(error)
                        }
                    })
                })
            </script>

        </div> <!-- main first -->

        <div class="main-first">
            <div id="last-three" class="three-posts">

                <script type="text/javascript">
                    $(document).ready(function(){
                        $.ajax({
                            url: 'users/last-posts',
                            success: function(data){
                                // console.log(data);
                                const posts = data.lastPosts;

                                var i = 0;
                                while(i < posts.length){

                                    const singlePost = $('<a>').addClass('single-post').attr({ 'href':'post?postId=' + posts[i].ID });
                                    const postImageDiv = $('<div>').addClass('post-image');
                                        const postImage = $('<img>').attr({ 'src': 'admin/post-image?image=' + posts[i].image });
                                    postImageDiv.append(postImage);
                                    
                                        const postTitle = $('<div>').addClass('post-title').append(posts[i].title);
                                        const postSmallTitle = $('<div>').addClass('post-small-title').append(posts[i].title);
                                        const postCategory = $('<a>').attr({ 'href':'category?catId=' + posts[i].category_id }).append(posts[i].category).css({ 'font-weight':'bold' });
                                        const postCatTile = $('<div>').addClass('post-cat-time').append(posts[i].time_posted + ' ' + '|' + ' ');
                                            postCatTile.append(postCategory);
                                    singlePost.append(postImageDiv)
                                    singlePost.append(postTitle)
                                    singlePost.append(postSmallTitle)
                                    singlePost.append(postCatTile)

                                    $('#last-three').append(singlePost);

                                    i++;
                                }
                            }, error: function(error){
                                // console.log(error)
                            }
                        })
                    })

                </script>

            </div><!-- three posts -->
        </div> <!-- main first -->


        <div id="categories-section" class="categories-section">
            <script type="text/javascript">
                $(document).ready(function(){
                    // console.log('leo zver')

                    $.ajax({
                        url: 'users/all-categories',
                        success: function(data){
                            const categories = data.categories
                            // console.log(data);

                            var i = 0;
                            while(i < categories.length){

                                const oneSectionWrapper = $('<div>').addClass('one-section');
                                    const sectionTop = $('<div>').addClass('featured-sec-top');
                                        const sectionTitle = $('<a>').addClass('featured-sec-title').append(categories[i].name).attr({ 'href':'category?id=' + categories[i].ID });
                                        const rightSign = $('<div>').addClass('right-sign');
                                            const rightSignImg = $('<img>').attr({ 'src':'client/right-arrow-icon' });
                                        rightSign.append(rightSignImg);
                                    sectionTop.append(sectionTitle);
                                    sectionTop.append(rightSign);
                                oneSectionWrapper.append(sectionTop);
                                    $.ajax({
                                        url: 'users/cat-big?catId=' + categories[i].ID,
                                        success: function(data){
                                            // console.log(data);
                                            const mainPost = data.post;
                                            // console.log(mainPost);

                                            const oneSectionMainPost = $('<a>').addClass('one-section-main-post').attr({ 'href':'post?postId=' + mainPost[0].ID });
                                                const mainSinglePost = $('<div>').addClass('main-single-post');
                                                    const postImgDiv = $('<div>').addClass('post-image');
                                                        const postImg = $('<img>').attr({ 'src': 'admin/post-image?image=' + mainPost[0].image });
                                                    postImgDiv.append(postImg);
                                                mainSinglePost.append(postImgDiv);
                                                    const postTitle = $('<div>').addClass('post-title').append(mainPost[0].title);
                                                mainSinglePost.append(postTitle);
                                            oneSectionMainPost.append(mainSinglePost);

                                            const space = $('<br>');

                                            oneSectionWrapper.append(space);
                                            oneSectionWrapper.append(oneSectionMainPost);
                                        }
                                    })

                                    $.ajax({
                                        url: 'users/cat-posts?id=' + categories[i].ID,
                                        success: function(data) {
                                            console.log(data);
                                            const catPosts = data.posts;

                                            const oneSectionSmallPosts = $('<div>').addClass('one-section-small-posts');
                                                var j = 0;
                                                while(j < catPosts.length){
                                                    const smallPost = $('<div>').addClass('small-post');
                                                        const smallPostImgDiv = $('<div>').addClass('small-post-image');
                                                            const smallPostImg = $('<img>').attr({ 'src': 'admin/post-image?image=' + catPosts[j].image });
                                                        smallPostImgDiv.append(smallPostImg);
                                                    smallPost.append(smallPostImgDiv);
                                                        const smallPostTitle = $('<div>').addClass('small-post-title').append(catPosts[j].title);
                                                    smallPost.append(smallPostTitle);

                                                    oneSectionSmallPosts.append(smallPost);
                                                    j++;
                                                }
                                                

                                            oneSectionWrapper.append(oneSectionSmallPosts);

                                        }, error: function(error){
                                            // console.log(error)
                                        }
                                    })

                                $('#categories-section').append(oneSectionWrapper);

                                i++;    
                            }
                        }
                    })
                })

            </script>    
        </div>


        
    </div><!-- main section -->




    <div id="footer-place" style="display: none"></div> <!-- footer place -->

    <div class="footer">
        <div class="footer-wrapper" style="border-bottom: 1px solid whitesmoke; padding-bottom: 30px">
            <div class="footer-logo">newsMK</div>

            <div class="footer-right-wrapper">
                <div class="social-media">
                    <div class="social-media-icon"><img src="client/facebook-icon"></div>
                    <div class="social-media-icon"><img src="client/insta-icon"></div>
                    <div class="social-media-icon"><img src="client/twitter-icon"></div>
                </div>
            </div>
        </div>

        <div class="footer-bottom">
            <div class="footer-bottom-item">Terms of use</div>
            <div class="footer-bottom-item">Privacy policy</div>
            <div class="footer-bottom-item">Accessibillity & CC</div>
            <div class="footer-bottom-item">AdChoices</div>
            <div class="footer-bottom-item">About Us</div>
            <div class="footer-bottom-item">Moder Slavery Act Statement</div>
            <div class="footer-bottom-item">Advertise with us</div>
            <div class="footer-bottom-item">newsMK Store</div>
            <div class="footer-bottom-item">Newsletter</div>
            <div class="footer-bottom-item">Trascripts</div>
            <div class="footer-bottom-item">License Footage</div>
            <div class="footer-bottom-item">newsMK Newsource</div>
            <div class="footer-bottom-item">Sitemap</div>
        </div>
    </div> <!-- footer -->
    
</body>
</html>